{{define "master"}}{{template "master_site" .}}{{end}}

{{define "view_head"}}

<div class="center">
	<h1>Sign in with passcode</h1>
</div>

{{end}}

{{define "view_body"}}

<div class="center">
	{{$useSMS := eq .Session.TOTPMethod "sms"}}

	{{if $useSMS}}
		<p>Please verify your identity by entering the 6 digit passcode that has been generated and sent to your registered phone number.</p>
	{{else}}
		<p>Please verify your identity by entering a 6 digit passcode that has been generated by your authenticator app.</p>
	{{end}}

	<form action="{{Path "account.sign_in.totp.post"}}" method="POST">
		{{template "com_csrf_input" .}}

		{{template "com_passcode_input" .WithProps
			"Label" "Passcode"
			"Name" "totp"
			"Required" true
			"Autocomplete" "one-time-code"
			"Autofocus" true
		}}

		<div class="bag reverse">
			<button{{if not $useSMS}} class="push-inline-end" {{end}}>Sign in</button>

			{{if $useSMS}}
				<button formnovalidate formaction="{{Path "account.totp.sms.send_passcode.post"}}" class="btn--alt push-inline-end">Resend passcode SMS</button>
			{{end}}

			<div class="stack">
				<a href="{{Path "account.sign_in.recovery_code"}}">Use a recovery code</a>
				<a href="{{Path "account.sign_in.totp.reset"}}">Locked out?</a>
			</div>
		</div>
	</form>
</div>

{{end}}
