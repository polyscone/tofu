{{define "view_head"}}

<div class="center">
	<h1>Sign in with passcode</h1>
</div>

{{end}}

{{define "view_body"}}

<div class="center">
	{{$useSMS := eq .Session.TOTPMethod "sms"}}

	{{if $useSMS}}
		<p>Please verify your identity by entering the 6 digit passcode that has been generated and sent to your registered phone number.</p>
	{{else}}
		<p>Please verify your identity by entering a 6 digit passcode that has been generated by your authenticator app.</p>
	{{end}}

	<form action="{{Path "account.sign_in.totp.post"}}" method="POST">
		<input type="hidden" name="_csrf" value="{{.CSRF.Token}}">

		<label for="sign-in__totp">Passcode</label>
		<input id="sign-in__totp" type="text" name="totp" placeholder="123456" autocomplete="one-time-code" required pattern="\d{6}" minlength="6" maxlength="6">
		<p class="error">{{.Errors.Get "totp"}}</p>

		<div class="bag reverse">
			<button type="submit"{{if not $useSMS}} class="push-inline-end" {{end}}>Sign in</button>

			{{if $useSMS}}
				<button type="submit" formnovalidate formaction="{{Path "account.totp.sms.send_passcode.post"}}" class="btn--alt push-inline-end">Resend passcode SMS</button>
			{{end}}

			<a href="{{Path "account.sign_in.recovery_code"}}">Use a recovery code</a>
		</div>
	</form>
</div>

{{end}}
